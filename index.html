<!DOCTYPE html>
<html lang="en">
<!-- Previous head and style sections remain the same -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DMBOK Quiz</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <style>
        .option:hover {
            background-color: #f3f4f6;
        }
        .selected {
            background-color: #dbeafe;
        }
        .correct {
            background-color: #d1fae5;
        }
        .incorrect {
            background-color: #fee2e2;
        }
        .progress-bar {
            transition: width 0.3s ease-in-out;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- Previous HTML structure remains the same -->
    <div class="container mx-auto px-4 py-8">
        <div class="max-w-3xl mx-auto">
            <!-- Welcome Screen -->
            <div id="welcome-screen" class="bg-white rounded-lg shadow-md p-8 mb-8">
                <h1 class="text-3xl font-bold text-center mb-6">DMBOK Knowledge Quiz</h1>
                <p class="text-gray-600 mb-6 text-center">Test your knowledge of the Data Management Body of Knowledge</p>
                <div class="flex justify-center">
                    <button id="start-btn" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors">
                        Start Quiz
                    </button>
                </div>
            </div>

            <!-- Quiz Container -->
            <div id="quiz-container" class="bg-white rounded-lg shadow-md p-8 hidden">
                <!-- Progress Bar -->
                <div class="mb-6">
                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                        <div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full progress-bar" style="width: 0%"></div>
                    </div>
                    <div class="flex justify-between mt-2 text-sm text-gray-600">
                        <span id="question-number">Question 1/50</span>
                        <span id="score-display">Score: 0</span>
                    </div>
                </div>

                <!-- Question -->
                <div id="question" class="text-xl font-semibold mb-6"></div>

                <!-- Options -->
                <div id="options" class="space-y-3 mb-6"></div>

                <!-- Navigation -->
                <div class="flex justify-between items-center">
                    <button id="prev-btn" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600 transition-colors hidden">
                        Previous
                    </button>
                    <button id="next-btn" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition-colors">
                        Next
                    </button>
                </div>
            </div>

            <!-- Results Screen -->
            <div id="results-screen" class="bg-white rounded-lg shadow-md p-8 hidden">
                <h2 class="text-2xl font-bold text-center mb-6">Quiz Complete!</h2>
                <div id="final-score" class="text-center text-xl mb-6"></div>
                <div id="score-breakdown" class="mb-6">
                    <h3 class="font-semibold mb-3">Performance by Category:</h3>
                    <div id="category-scores" class="space-y-2"></div>
                </div>
                <div class="flex justify-center space-x-4">
                    <button id="restart-btn" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition-colors">
                        Restart Quiz
                    </button>
                    <button id="share-btn" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition-colors">
                        Share Results
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const questions = [
            {
                category: "Data Governance",
                question: "Which of the following is NOT typically a role in data governance?",
                options: [
                    "Data Steward",
                    "Database Administrator",
                    "Marketing Manager",
                    "Data Owner"
                ],
                correct: 2,
                answered: false
            },
            {
                category: "Data Quality",
                question: "Which data quality dimension measures whether the data is available when needed?",
                options: [
                    "Accuracy",
                    "Timeliness",
                    "Completeness",
                    "Consistency"
                ],
                correct: 1,
                answered: false
            }
        ];

        let currentQuestion = 0;
        let score = 0;
        let answers = new Array(questions.length).fill(null);
        let categoryScores = {};

        // Initialize category scores
        questions.forEach(q => {
            if (!categoryScores[q.category]) {
                categoryScores[q.category] = {
                    correct: 0,
                    total: 0
                };
            }
            categoryScores[q.category].total++;
        });

        // DOM Elements
        const welcomeScreen = document.getElementById('welcome-screen');
        const quizContainer = document.getElementById('quiz-container');
        const resultsScreen = document.getElementById('results-screen');
        const questionElement = document.getElementById('question');
        const optionsElement = document.getElementById('options');
        const nextButton = document.getElementById('next-btn');
        const prevButton = document.getElementById('prev-btn');
        const progressBar = document.getElementById('progress-bar');
        const questionNumber = document.getElementById('question-number');
        const scoreDisplay = document.getElementById('score-display');

        // Event Listeners
        document.getElementById('start-btn').addEventListener('click', startQuiz);
        document.getElementById('restart-btn').addEventListener('click', restartQuiz);
        document.getElementById('share-btn').addEventListener('click', shareResults);
        nextButton.addEventListener('click', nextQuestion);
        prevButton.addEventListener('click', previousQuestion);

        function startQuiz() {
            welcomeScreen.classList.add('hidden');
            quizContainer.classList.remove('hidden');
            showQuestion();
        }

        function showQuestion() {
            const question = questions[currentQuestion];
            questionElement.textContent = question.question;
            optionsElement.innerHTML = '';

            question.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.className = 'option w-full text-left p-4 rounded border border-gray-300 transition-colors';
                button.textContent = option;
                
                if (answers[currentQuestion] === index) {
                    button.classList.add('selected');
                    // If the question is answered, show correct/incorrect feedback
                    if (question.answered) {
                        if (index === question.correct) {
                            button.classList.add('correct');
                        } else if (answers[currentQuestion] === index) {
                            button.classList.add('incorrect');
                        }
                    }
                }

                button.addEventListener('click', () => selectOption(index));
                optionsElement.appendChild(button);
            });

            updateNavigation();
            updateProgress();
        }

        function selectOption(index) {
            const question = questions[currentQuestion];
            if (!question.answered) {
                const options = optionsElement.children;
                for (let option of options) {
                    option.classList.remove('selected', 'correct', 'incorrect');
                }
                
                options[index].classList.add('selected');
                answers[currentQuestion] = index;
                question.answered = true;

                // Show correct/incorrect feedback immediately
                if (index === question.correct) {
                    options[index].classList.add('correct');
                    score++;
                } else {
                    options[index].classList.add('incorrect');
                    options[question.correct].classList.add('correct');
                }

                // Update the score display
                updateProgress();
            }
        }

        function nextQuestion() {
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                showQuestion();
            } else {
                showResults();
            }
        }

        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                showQuestion();
            }
        }

        function updateNavigation() {
            prevButton.classList.toggle('hidden', currentQuestion === 0);
            nextButton.textContent = currentQuestion === questions.length - 1 ? 'Finish' : 'Next';
        }

        function updateProgress() {
            const progress = ((currentQuestion + 1) / questions.length) * 100;
            progressBar.style.width = `${progress}%`;
            questionNumber.textContent = `Question ${currentQuestion + 1}/${questions.length}`;
            scoreDisplay.textContent = `Score: ${score}/${questions.length}`;
        }

        function showResults() {
            quizContainer.classList.add('hidden');
            resultsScreen.classList.remove('hidden');

            // Calculate final scores for categories
            Object.keys(categoryScores).forEach(category => {
                categoryScores[category].correct = questions.reduce((total, q, index) => {
                    if (q.category === category && answers[index] === q.correct) {
                        return total + 1;
                    }
                    return total;
                }, 0);
            });

            // Display final score
            const percentage = (score / questions.length) * 100;
            document.getElementById('final-score').textContent = 
                `Final Score: ${score}/${questions.length} (${percentage.toFixed(1)}%)`;

            // Display category breakdown
            const categoryScoresElement = document.getElementById('category-scores');
            categoryScoresElement.innerHTML = '';
            
            Object.entries(categoryScores).forEach(([category, scores]) => {
                const categoryPercentage = (scores.correct / scores.total) * 100;
                const div = document.createElement('div');
                div.className = 'flex justify-between items-center';
                div.innerHTML = `
                    <span>${category}:</span>
                    <span>${scores.correct}/${scores.total} (${categoryPercentage.toFixed(1)}%)</span>
                `;
                categoryScoresElement.appendChild(div);
            });
        }

        function restartQuiz() {
            currentQuestion = 0;
            score = 0;
            answers = new Array(questions.length).fill(null);
            questions.forEach(q => q.answered = false);
            Object.keys(categoryScores).forEach(category => {
                categoryScores[category].correct = 0;
            });
            
            resultsScreen.classList.add('hidden');
            welcomeScreen.classList.remove('hidden');
        }

        function shareResults() {
            const text = `I scored ${score}/${questions.length} on the DMBOK Quiz!`;
            if (navigator.share) {
                navigator.share({
                    title: 'DMBOK Quiz Results',
                    text: text,
                    url: window.location.href
                });
            } else {
                // Fallback to copying to clipboard
                navigator.clipboard.writeText(text)
                    .then(() => alert('Results copied to clipboard!'))
                    .catch(() => alert('Unable to copy results'));
            }
        }
    </script>
</body>
</html>
